% ====================================================
\section{Numerical results}\label{sec:Num_Result}
% ====================================================
We present numerical experiments that demonstrate the effectiveness of the proposed iterative and adaptive integer-valued sample allocation scheme. The method is evaluated against three benchmark strategies: (i) the standard real-valued MFMC allocation, (ii) direct flooring of the real-valued solution, and (iii) the modified rounding method of \cite{GrGuJuWa:2023}. Performance is assessed in terms of realized computational cost and the resulting normalized variance under fixed budget constraints. All experiments are performed in {\tt MATLAB} R2024a on a MacBook Pro with 24 GB RAM and a 14-core Apple M4 Pro processor.




\subsection{First example}
Table~\ref{tab:MFMC_integer_comparison_Eg1} reports the model parameters derived from a plasma physics application \cite{ElLiSa:2023,ElLiSa:2025}. The hierarchy comprises five fidelity levels exhibiting strong cross-model correlations ($\rho_{1,k}>0.98$) and rapidly decaying computational costs.



For the smallest budget ($b=73.03$), the results illustrate the fragility of naive rounding. Direct flooring entirely eliminates the high-fidelity model and produces an infeasible MFMC estimator with unbounded variance. The modified ceil–floor strategy restores feasibility but significantly overestimates the variance relative to the continuous benchmark. The iterative approach, in contrast, saturates the budget exactly and reduces the error by roughly 5\% compared to the modified method. When duplicate sample counts are removed, the variance drops further to $1.79\times 10^{-2}$, matching the integer-programming optimum. These results show that, under tight computational budgets, the iterative procedure is markedly more robust and better aligned with the sensitivity structure of the continuous solution.

This table presents the resulting allocations for two representative budget levels. For the large-budget case ($b=200$), the real-valued allocation achieves the theoretical minimum variance $f=2.1645\times 10^{-4}$. Direct flooring underutilizes the budget by roughly 15\% (actual cost $\approx 169.86$), which leads to an 18\% increase in variance. The proposed iterative integer scheme, by contrast, fully saturates the budget and yields a variance within 12\% of the continuous optimum, illustrating that the method preserves most of the performance predicted by the idealized real-valued formulation.


The small-budget case ($b=73.03$) is more delicate and reveals failures of conventional rounding. Direct flooring omits the highest-fidelity model and thus produces an infeasible MFMC estimator with unbounded variance. The modified rounding strategy ensures feasibility but incurs a significantly larger error, yielding $f=2.4834\times 10^{-2}$. The iterative scheme improves on this result, reducing the variance by approximately 5\% while still  meeting the prescribed budget. Removing a single redundant fidelity model from the iterative allocation further decreases the variance to $1.79\times 10^{-2}$, outperforming the modified rounding result of $2.48\times 10^{-2}$. These observations highlight that the iterative procedure not only preserves feasibility under tight budgets but also adapts effectively to local sensitivity in the allocation landscape, yielding consistently lower variance than existing integer-based methods.








% %
% \begin{table}[ht]
% \centering
% \scalebox{1}{
% \begin{tabular}{|c|c|c|c|c|c|c|}
% \hline
% Model index &1 &2 &3 &4 &5 \\
% \hline
% Correlation coeff $\rho_{1,k}$ &1     &9.9977e-01   &9.9925e-01  &9.9728e-01   &9.8390e-01\\
% % \hline
% % Standard deviation $\sigma_k$ &1.0840e-02    &1.0838e-02   &1.1001e-02  &1.1549e-02   &9.5720e-03\\
% \hline
% Cost &73&7.0318e-03 &1.4018e-03 &5.0613e-04 &2.6803e-04\\
% \hline
% \end{tabular}
% }
% \caption{Model parameters for the plasma physics example in \cite{ElLiSa:2023,ElLiSa:2025}.}
% \label{Tab:Eg1_Parameters}
% \end{table}
% %


% \begin{table}[ht]
% \centering
% \scalebox{0.73}{
% \begin{tabular}{|c|p{4.8cm}|c|c|p{4.8cm}|c|c|}
% \hline
% \multirow{2}{*}{Method} 
% & \multicolumn{3}{c|}{$b = 73.03$} 
% & \multicolumn{3}{c|}{$b = 200$} \\
% \cline{2-7}
% & Sample size & Actual cost & Actual $f$ 
% & Sample size & Actual cost & Actual $f$ \\
% \hline
% Real-valued 
% & [8.8106e-01, 1.3495e+02, 5.8795e+02, 2.5402e+03, 2.1095e+04] 
% & 7.3030e+01 & 5.9275e-04 
% & [2.4129e+00, 3.6959e+02, 1.6102e+03, 6.9567e+03, 5.7770e+04] 
% & 2.0000e+02 & 2.1645e-04 \\
% \hline
% Direct floor 
% & [0, 134, 587, 2540, 21094] 
% & 8.7045e+00 & $\infty$ 
% & [2, 369, 1610, 6956, 57769] 
% & 1.6986e+02 & 2.5580e-04 \\
% \hline
% Modified 
% & [1, 1, 1, 7, 62] 
% & 7.3029e+01 & 2.4834e-02 
% & \multicolumn{3}{c|}{---} \\
% \hline
% Iterative 
% & [1, 1, 1, 7, 67] 
% & 7.3030e+01 & 2.3668e-02 
% & [2, 836, 3644, 15744, 130749] 
% & 2.0000e+02 & 2.4138e-04 \\
% \hline
% Iterative (delete equal)
% &[1, -, 2, 9, 84]
% &7.3030e+01
% &1.7936e-02
% & \multicolumn{3}{c|}{---} \\
% \hline
% Iterative (adaptive)
% &[1, 0, 2, 10, 82]
% &7.3030e+01
% &1.7922e-02
% &[2, 836, 3644, 15745, 130747]
% &2.0000e+02
% &2.4138e-04\\
% \hline
% Integer program
% &[1, 0, 2, 10, 82]
% &7.3029e+01 &1.7922e-02
% &[2, 836, 3644, 15741, 130755]
% &2.0000e+02&2.4138e-04\\
% \hline
% \end{tabular}
% }
% \caption{Comparison of real-valued and integer-valued MFMC sample allocations for small and large budgets ($b=73.03$ and $b=200$).}
% \label{tab:MFMC_integer_comparison_Eg1}
% \end{table}


% \begin{table}[ht]
% \centering
% \scalebox{0.73}{
% \begin{tabular}{|c|p{4.8cm}|c|c|p{4.8cm}|c|c|}
% \hline
% \multirow{2}{*}{Method} 
% & \multicolumn{3}{c|}{$b = 248$} 
% & \multicolumn{3}{c|}{$b = 828$} \\
% \cline{2-7}
% & Sample size & Actual cost & Actual $f$ 
% & Sample size & Actual cost & Actual $f$ \\
% \hline
% Real-valued 
% & [2.9920e+00, 4.5829e+02,   1.9966e+03,   8.6262e+03,   7.1634e+04] 
% & 248 & 1.7455e-04
% & [9.9893e+00,   1.5301e+03,   6.6661e+03,   2.8800e+04, 2.3917e+05] 
% &828 &5.2282e-05\\
% \hline
% Direct floor 
% & [2, 458, 1996, 8626, 71634] 
% & 1.7559e+02 & 2.5080e-04
% & [9, 1530, 6666, 28800, 239166] 
% &7.5578e+02 &5.7343e-05 \\
% \hline
% % Modified 
% % & [] 
% % &  & 
% % & [] 
% % & & \\
% % % & \multicolumn{3}{c|}{---} \\
% % \hline
% Iterative 
% & [2,        1579,        6883,       29740, 246971] 
% & 2.4800e+02 & 2.3601e-04
% & [9,        2648,       11539,       49856,  414023] 
% &8.2800e+02 & 5.4709e-05\\
% \hline
% % Iterative (delete equal)
% % & [] 
% % &  & 
% % & [] 
% % & & \\
% % % & \multicolumn{3}{c|}{---} \\
% % \hline
% Iterative (adaptive)
% & [3,         449,        1957,        8455, 70216] 
% & 2.4800e+02 & 1.7456e-04
% & [10,        1518,        6613,       28572,   237266] 
% & 8.2800e+02&5.2282e-05 \\
% \hline
% Integer program
% & [3, 449, 1958, 8455, 70211] 
% & 2.4800e+02 & 1.7456e-04
% & [10, 1518, 6617, 28569,  237251]
% & 8.2800e+02& 5.2282e-05\\
% \hline
% \end{tabular}
% }
% \caption{Comparison of real-valued and integer-valued MFMC sample allocations for small and large budgets ($b=248$ and $b=828$).}
% \label{tab:MFMC_integer_comparison_Eg1}
% \end{table}


\begin{table}[ht]
\centering
\scalebox{0.9}{
\begin{tabular}{cc} % no outer border

% ---------- LEFT: PARAMETERS ----------
\begin{minipage}{0.2\linewidth}
\centering
\small
\begin{tabular}{|c|c|}
\hline
\textbf{Model} & \textbf{$\rho_{1,k}$} \\
\hline
1 & 1 \\
2 & 9.9977e-01 \\
3 & 9.9925e-01 \\
4 & 9.9728e-01 \\
5 & 9.8390e-01 \\
\hline
& \textbf{Cost} \\ \hline
1 & 73 \\
2 & 7.0318e-03 \\
3 & 1.4018e-03 \\
4 & 5.0613e-04 \\
5 & 2.6803e-04 \\
\hline
\end{tabular}
\end{minipage}
&
% ---------- RIGHT: RESULTS ----------
\begin{minipage}{0.8\linewidth}
\centering
\small
\begin{tabular}{|c|p{5.5cm}|c|c|}
\hline
\textbf{Method} & \textbf{Sample size} & \textbf{Cost} & \textbf{$f$} \\ \hline

\multicolumn{4}{|c|}{\textbf{Budget: $b = 73.03$}} \\ \hline
Real-valued 
& [8.81e-01, 1.35e+02, 5.88e+02, 2.54e+03, 2.11e+04]
& 7.30e+01 & 5.9275e-04  \\ \hline
Direct floor 
& [0, 134, 587, 2540, 21094]
& 8.70e+00 & $\infty$ \\ \hline
Modified 
& [1, 1, 1, 7, 62]
& 7.30e+01 & 2.4834e-02  \\ \hline
Iterative 
& [1, 1, 1, 7, 67]
& 7.30e+01 & 2.3668e-02 \\ \hline
Iterative (delete equal)
& [1, -, 2, 9, 84]
& 7.30e+01 & 1.7936e-02 \\ \hline
Iterative (adaptive)
& [1, -, 2, 10, 82]
& 7.30e+01 & 1.7922e-02 \\ \hline
Integer program
& [1, -, 2, 10, 82]
& 7.30e+01 & 1.7922e-02 \\ \hline

\multicolumn{4}{|c|}{\textbf{Budget: $b = 200$}} \\ \hline
Real-valued 
& [2.41e+00, 3.70e+02, 1.61e+03, 6.96e+03, 5.78e+04]
& 2.00e+02 & 2.1645e-04  \\ \hline
Direct floor 
& [2, 369, 1610, 6956, 57769]
& 1.70e+02 & 2.5580e-04 \\ \hline
Iterative 
& [2, 836, 3644, 15744, 130749]
& 2.00e+02 & 2.4138e-04  \\ \hline
Iterative (adaptive)
& [2, 836, 3644, 15745, 130747]
& 2.00e+02 & 2.4138e-04 \\ \hline
Integer program
& [2, 836, 3644, 15741, 130755]
& 2.00e+02 & 2.4138e-04 \\ \hline

% \multicolumn{4}{|c|}{\textbf{Budget: $b = 248$}} \\ \hline
% Real-valued 
% & [2.9920e+00, 4.5829e+02, 1.9966e+03, 8.6262e+03, 7.1634e+04]
% & 2.48e+02 & 1.7455e-04 \\ \hline
% Direct floor 
% & [2, 458, 1996, 8626, 71634]
% & 1.76e+02 & 2.51e-04 \\ \hline
% Iterative 
% & [2, 1579, 6883, 29740, 246971]
% & 2.48e+02 & 2.36e-04 \\ \hline
% Iterative (adaptive)
% & [3, 449, 1957, 8455, 70216]
% & 2.48e+02 & 1.746e-04 \\ \hline
% Integer program
% & [3, 449, 1958, 8455, 70211]
% & 2.48e+02 & 1.746e-04 \\ \hline

\multicolumn{4}{|c|}{\textbf{Budget: $b = 828$}} \\ \hline
Real-valued 
& [9.9893e+00, 1.5301e+03, 6.6661e+03, 2.8800e+04, 2.3917e+05]
& 8.28e+02 & 5.2282e-05 \\ \hline
Direct floor 
& [9, 1530, 6666, 28800, 239166]
& 7.56e+02 & 5.7343e-05  \\ \hline
Iterative 
& [9, 2648, 11539, 49856, 414023]
& 8.28e+02 & 5.4709e-05 \\ \hline
Iterative (adaptive)
& [10, 1518, 6613, 28572, 237266]
& 8.28e+02 & 5.2282e-05 \\ \hline
Integer program
& [10, 1518, 6617, 28560, 237268]
& 8.28e+02 & 5.2282e-05 \\ \hline

\end{tabular}
\end{minipage}

\end{tabular}
}
\caption{Model parameters and MFMC sample allocations for the plasma physics example in \cite{ElLiSa:2023,ElLiSa:2025}, for budgets $b=73.03$, $200$, and $828$. Each budget block corresponds to a separate allocation result.}
\label{tab:MFMC_integer_comparison_Eg1}
\end{table}













%
\begin{figure}[!t]\centering
\begin{tabular}{cc}
\includegraphics[width=0.48\linewidth]{./Figures/Eg1_f_Cost.pdf}&
\includegraphics[width=0.48\linewidth]{./Figures/Eg1_Cost.pdf} \\
\includegraphics[width=0.48\linewidth]{./Figures/Eg1_f.pdf}
\end{tabular}
\caption{
Budget sensitivity analysis for the the first example. Top left: actual variance and cost for an increasing budget $b$. Top right: relative cost deviation $(b - \sum_k C_k \lfloor \cdot \rfloor)/b$ versus prescribed budget $b$. Bottom left: relative variance deviation $(f(\lfloor \cdot \rfloor) - f(N_k^*))/f(N_k^*)$ versus prescribed budget $b$. 
} 
\label{fig:Eg1} 
\end{figure}
%

Figure~\ref{fig:Eg1} examines the actual cost and variance of the compared methods and investigates the sensitivity of cost utilization and variance performance to the prescribed budget $b \in [\sum_k C_k, 10^4]$. The results reveal the relative performance of integer-valued allocation schemes with respect to the continuous optimum. The top-left panel presents the actual cost and normalized variance obtained from both the direct flooring and iterative approaches. The flooring method exhibits the characteristic staircase pattern in both variance and cost, a direct consequence of the discrete nature of integer allocations. In contrast, the iterative approach achieves near-optimal budget utilization that closely follows the real-valued solution, effectively mitigating the variance inflation observed under direct flooring. As $b$ increases, both integer-based schemes asymptotically approach the real-valued allocation, and the convergence of all curves at high budgets indicates that the impact of integer constraints diminishes as sample sizes grow. Budget under-utilization, quantified in the top-right panel through the metric $b - \sum_k C_k \lfloor \cdot \rfloor$, further distinguishes the two methods. The iterative scheme maintains nearly perfect adherence to the prescribed budget across all levels, with deviations remaining at numerical precision. In contrast, direct flooring exhibits persistent relative under-utilization roughly six orders of magnitude larger over most of the budget range. This pronounced disparity highlights the iterative method’s ability to fully exploit available computational resources and maintain consistency with the prescribed cost constraint.  The bottom-left panel displays variance inflation relative to the continuous optimum, measured by $\sum_k (\Delta_k/\lfloor \cdot \rfloor - \Delta_k/N_k^*)$. The direct floor allocation approaches but never exceeds the upper bound $\sum_k (\Delta_k/(N_k^*-1) - \Delta_k/N_k^*)$ (shown in red), confirming the sharpness of the bound established in \eqref{eq:bounds_for_floor}. Both integer schemes incur the expected penalty associated with discrete allocations; however, the iterative method consistently yields lower variance than direct flooring across all budgets, highlighting the robustness of the proposed allocation strategy.  The staircase and sawtooth patterns evident throughout the figures originate from the fundamental discreteness of integer allocations. As the budget $b$ increases continuously, the real-valued optimal allocation $N_k^*$ evolves smoothly, whereas the integer-valued allocations $\lfloor N_k^* \rfloor$ and $\lfloor M_k^* \rfloor$ remain constant until specific threshold budgets trigger discrete increments in sample counts. 







\subsection{Second example}
We next consider a four-fidelity configuration from the benchmark parameters of tubular reactor problem in \cite{PeWiGu:2016}, summarized in Table~\ref{Tab:Eg2_Parameters}. This test case represents a particularly challenging allocation scenario, featuring near-perfect inter-fidelity correlations ($\rho_{1,k} \approx 1$) and computational costs spanning more than five orders of magnitude. 

For a moderate budget of $b=200$, the real-valued allocation achieves an optimal variance of $f=5.0571\times10^{-5}$. Direct flooring, however, leads to substantial budget under-utilization ($b \approx 179.34$) and increases the variance by approximately 15\% to $f=5.8074\times10^{-5}$. In contrast, the proposed iterative scheme maintains exact budget adherence and limits the variance penalty to only 6\% above the continuous optimum ($f=5.3495\times10^{-5}$).

Under a more constrained budget of $b=46$, the direct flooring approach produces a degenerate estimator with infinite variance due to the exclusion of the highest-fidelity model. The modified rounding strategy restores estimator feasibility with a variance of $f=5.1658\times10^{-3}$, while the iterative method achieves an additional 7\% variance reduction to $f=4.8046\times10^{-3}$ through a more balanced allocation of samples across fidelity levels. Further refinement—removing the second model after detecting equal sample sizes—yields a variance reduction to $f=2.6060\times10^{-3}$.

Figure~\ref{fig:Eg2} illustrates that these performance advantages persist across the entire budget range: the iterative scheme consistently achieves near-perfect cost utilization and superior variance performance compared to direct flooring. Overall, these results confirm the robustness of the proposed iterative allocation strategy, particularly in multi-fidelity settings with extreme cost and correlation disparities. The improvement is most pronounced in the practically relevant regime of moderate budgets, where computational resources are limited and integer constraints typically degrade efficiency.




\begin{table}[ht]
\centering
\scalebox{0.9}{
\begin{tabular}{cc} % no outer border

% ---------- LEFT: PARAMETERS ----------
\begin{minipage}{0.2\linewidth}
\centering
\small
\begin{tabular}{|c|c|}
\hline
\textbf{Model} & \textbf{$\rho_{1,k}$} \\
\hline
1 & 1 \\
2 & 9.9999e-01 \\
3 & 9.9997e-01 \\
4 & 9.9583e-01 \\
\hline
&\textbf{Cost}\\
\hline
1 & 44.395 \\
2 & 6.8409e-01 \\
3 & 2.9937e-01 \\
4 & 1.9908e-04 \\
\hline
\end{tabular}
\end{minipage}
&
% ---------- RIGHT: RESULTS ----------
\begin{minipage}{0.8\linewidth}
\centering
\small
\begin{tabular}{|c|p{5.5cm}|c|c|c|}
\hline
\textbf{Method} & \textbf{Sample size} & \textbf{Cost} & \textbf{$f$}\\ \hline

\multicolumn{4}{|c|}{\textbf{Budget: $b = 46$}} \\ \hline
Real-valued 
& [3.3349e-01, 2.9158e+00, 7.6071e+01, 3.2282e+04]
& 4.60e+01 & 2.1987e-04 \\ \hline
Direct floor 
& [0, 2, 76, 32282]
& 3.05e+01 & $\infty$ \\ \hline
Modified 
& [1, 1, 2, 1018]
& 4.588e+01 & 5.1658e-03 \\ \hline
Iterative 
& [1, 1, 2, 1618]
& 4.60e+01 & 4.8046e-03 \\ \hline
Iterative (delete equal)
& [1, -, 4, 2047]
& 4.60e+01 & 2.6060e-03 \\ \hline
Iterative (adaptive)
& [1, -, 4, 2047]
& 4.60e+01 & 2.6060e-03 \\ \hline
Integer program
& [1, -, 4, 2047]
& 4.60e+01 & 2.6060e-03 \\ \hline

\multicolumn{4}{|c|}{\textbf{Budget: $b = 248$}} \\ \hline
Real-valued 
& [1.7979e+00, 1.5720e+01, 4.1012e+02, 1.7404e+05]
& 2.48e+02 & 4.0783e-05 \\ \hline
Direct floor 
& [1, 15, 410, 174042]
& 2.1205e+02 & 5.1348e-05 \\ \hline
Iterative 
& [1, 19, 496, 211572]
& 2.48e+02 & 4.6445e-05 \\ \hline
Iterative (adaptive)
& [2, 15, 388, 164723]
& 2.48e+02 & 4.1015e-05 \\ \hline
Integer program
& [2,     18,    383, 161933] 
&2.4800e+02 &4.1089e-05 \\ \hline
\end{tabular}
\end{minipage}

\end{tabular}
}
\caption{Model parameters and MFMC sample allocations for the tubular reactor example in \cite{PeWiGu:2016}, for budgets $b=46$ and $b=248$. The iterative integer-valued scheme achieves better cost utilization than direct flooring while preserving the structure of the continuous optimizer.}
\label{tab:MFMC_integer_comparison_Eg2}
\end{table}


% %
% \begin{table}[ht]
% \centering
% \scalebox{1}{
% \begin{tabular}{|c|c|c|c|c|c|c|}
% \hline
% Model index &1 &2 &3 &4 \\
% \hline
% Correlation coeff $\rho_{1,k}$ &1     &9.9999e-01  &9.9997e-01 &9.9583e-01\\
% % \hline
% % Standard deviation $\sigma_k$ &0.03\\
% \hline
% Cost &44.395 &6.8409e-01 &2.9937e-01 &1.9908e-04\\
% \hline
% \end{tabular}
% }
% \caption{Parameters of tubular reactor problem in \cite{PeWiGu:2016}.}
% \label{Tab:Eg2_Parameters}
% \end{table}
% %

% \begin{table}[ht]
% \centering
% \scalebox{0.73}{
% \begin{tabular}{|c|p{4.8cm}|c|c|p{4.8cm}|c|c|}
% \hline
% \multirow{2}{*}{Method} 
% & \multicolumn{3}{c|}{$b = 46$} 
% & \multicolumn{3}{c|}{$b = 248$} \\
% \cline{2-7}
% & Sample size & Actual cost & Actual $f$ 
% & Sample size & Actual cost & Actual $f$ \\
% \hline
% Real-valued 
% & [3.3349e-01, 2.9158e+00, 7.6071e+01, 3.2282e+04] 
% & 4.6000e+01 & 2.1987e-04 
% & [1.7979e+00,   1.5720e+01,   4.1012e+02,   1.7404e+05] 
% &248& 4.0783e-05\\
% \hline
% Direct floor 
% & [0, 2, 76, 3.2282e+04] 
% & 3.0547e+01 & $\infty$ 
% & [1, 15, 410, 174042]
% & 2.1205e+02&5.1348e-05\\
% \hline
% Modified 
% & [1, 1, 2, 1.0180e+03] 
% & 4.5880e+01 & 5.1658e-03 
% & \multicolumn{3}{c|}{---} \\
% \hline
% Iterative 
% & [1, 1, 2, 1.6180e+03] 
% & 4.6000e+01 & 4.8046e-03 
% & [1,          19,         496,      211572] 
% & 2.4800e+02&4.6445e-05 \\
% \hline
% Iterative (delete equal)
% &[1, -, 4, 2047]
% &4.6000e+01
% &2.6060e-03
% & \multicolumn{3}{c|}{---} \\
% \hline
% Iterative (adaptive)
% & [1, -, 4, 2047] 
% &4.6000e+01  &2.6060e-03
% & [2,15,388,164723]
% &2.4800e+02 & 4.1015e-05\\
% \hline
% Integer program
% &[1, -, 4, 2047]
% &4.6000e+01  &2.6060e-03
% &[]
% &\\
% \hline
% \end{tabular}
% }
% \caption{Comparison of real-valued and integer-valued MFMC sample allocations for small and large budgets ($b=46$ and $b=248$). The iterative integer-valued scheme achieves better cost utilization than the direct flooring approach while preserving the structure of the continuous optimizer.}
% \label{tab:MFMC_integer_comparison_Eg2}
% \end{table}



%
\begin{figure}[!t]\centering
\begin{tabular}{cc}
\includegraphics[width=0.48\linewidth]{./Figures/Eg2_f_Cost.pdf}&
\includegraphics[width=0.48\linewidth]{./Figures/Eg2_Cost.pdf}\\
\includegraphics[width=0.48\linewidth]{./Figures/Eg2_f.pdf}
\end{tabular}
\caption{
Budget sensitivity analysis for the the second example. Top left: actual variance and cost for an increasing budget $b$. Top right: relative cost deviation $(b - \sum_k C_k \lfloor \cdot \rfloor)/b$ versus prescribed budget $b$. Bottom left: relative variance deviation $(f(\lfloor \cdot \rfloor) - f(N_k^*))/f(N_k^*)$ versus prescribed budget $b$. 
} 
\label{fig:Eg2} 
\end{figure}
%




\subsection{Third example}
% %
% \begin{table}[ht]
% \centering
% \scalebox{1}{
% \begin{tabular}{|c|c|c|c|c|c|c|}
% \hline
% Model index &1 &2 &3\\
% \hline
% Correlation coeff $\rho_{1,k}$ &1     &0.9819  &0.9708\\
% % \hline
% % Standard deviation $\sigma_k$ &0.03\\
% \hline
% Cost &240.5123 &0.0166 &0.0017\\
% \hline
% \end{tabular}
% }
% \caption{Parameters of plasma turbulence problem in \cite{KoFaPeDiJeNeBu:2022}.}
% \label{Tab:Eg3_Parameters}
% \end{table}
% %


% \begin{table}[ht]
% \centering
% \scalebox{0.73}{
% \begin{tabular}{|c|p{4.8cm}|c|c|p{4.8cm}|c|c|}
% \hline
% \multirow{2}{*}{Method} 
% & \multicolumn{3}{c|}{$b = 240.8$} 
% & \multicolumn{3}{c|}{$b = 960$} \\
% \cline{2-7}
% & Sample size & Actual cost & Actual $f$ 
% & Sample size & Actual cost & Actual $f$ \\
% \hline
% Real-valued 
% & [9.8148e-01,   9.1833e+01,   1.8922e+03] 
% &240.8 &3.7283e-02
% & [3.9129e+00,   3.6611e+02,   7.5438e+03] 
% & 9.6000e+02 &9.3519e-03\\
% \hline
% Direct floor 
% & [0,          91,        1892] 
% & 4.7270e+00& $\infty$
% & [3,         366,        7543] 
% & 9.6000e+02&1.2142e-02\\
% \hline
% Modified 
% & [1,5,114] 
% & 2.4079e+02&4.8475e-02
% & \multicolumn{3}{c|}{---} \\
% \hline
% Iterative 
% & [1,5,120] 
% & 2.4080e+02&4.8061e-02
% & [3,        4618,       95178] 
% & 9.6000e+02&1.1972e-02\\
% \hline
% % Iterative (delete equal)
% % & [] 
% % & &
% % & [] 
% % & &\\
% % \hline
% % & \multicolumn{3}{c|}{---} \\
% Iterative (adaptive)
% & [1,6,110]
% & 2.4080e+02 &4.8053e-02
% & [3,        4619,       95169] 
% & 9.6000e+02&1.1972e-02\\
% \hline
% Integer program
% & [] 
% & &
% & [] 
% & &\\
% \hline
% \end{tabular}
% }
% \caption{Comparison of real-valued and integer-valued MFMC sample allocations for small and large budgets ($b=46$ and $b=248$). The iterative integer-valued scheme achieves better cost utilization than the direct flooring approach while preserving the structure of the continuous optimizer.}
% \label{tab:MFMC_integer_comparison_Eg3}
% \end{table}

% =======================
% PARAMETERS + RESULTS
% =======================
\begin{table}[ht]
\centering
\scalebox{0.92}{
\begin{tabular}{cc} % no outer border

% ---------- LEFT: PARAMETERS ----------
\begin{minipage}{0.25\linewidth}
\centering
\small
\begin{tabular}{|c|c|}
\hline
\textbf{Model} & \textbf{$\rho_{1,k}$} \\
\hline
1 & 1 \\
2 & 0.9819 \\
3 & 0.9708 \\
\hline
&\textbf{Cost}\\
\hline
1 & 240.5123 \\
2 & 1.66e-02 \\
3 & 1.70e-03 \\
\hline
\end{tabular}
\end{minipage}
&
% ---------- RIGHT: RESULTS ----------
\begin{minipage}{0.73\linewidth}
\centering
\small
\begin{tabular}{|c|p{4.9cm}|c|c|}
\hline
\textbf{Method} & \textbf{Sample size} & \textbf{Cost} & \textbf{$f$} \\ \hline

% ======= Budget block 1 =======
\multicolumn{4}{|c|}{\textbf{Budget: $b = 240.8$}} \\ \hline

Real-valued 
& [9.8148e-01, 9.1833e+01, 1.8922e+03]
& 2.408e+02 & 3.7283e-02 \\ \hline

Direct floor 
& [0, 91, 1892]
& 4.727e+00 & $\infty$ \\ \hline

Modified 
& [1, 5, 114]
& 2.4079e+02 & 4.8475e-02 \\ \hline

Iterative 
& [1, 5, 120]
& 2.4080e+02 & 4.8061e-02 \\ \hline

Iterative (adaptive)
& [1, 6, 110]
& 2.4080e+02 & 4.8053e-02 \\ \hline

Integer program
& [1,   6, 110]
& 2.4080e+02 & 4.8053e-02 \\ \hline


% ======= Budget block 2 =======
\multicolumn{4}{|c|}{\textbf{Budget: $b = 960$}} \\ \hline

Real-valued 
& [3.9129e+00, 3.6611e+02, 7.5438e+03]
& 9.6000e+02 & 9.3519e-03 \\ \hline

Direct floor 
& [3, 366, 7543]
& 9.6000e+02 & 1.2142e-02 \\ \hline

Iterative 
& [3, 4618, 95178]
& 9.6000e+02 & 1.1972e-02 \\ \hline

Iterative (adaptive)
& [3, 4619, 95169]
& 9.6000e+02 & 1.1972e-02 \\ \hline

Integer program
& [3,  4618, 95179]
& 9.6000e+02 & 1.1972e-02 \\ \hline

\end{tabular}
\end{minipage}

\end{tabular}
}
\caption{Model parameters and MFMC sample allocations for the plasma turbulence example in \cite{KoFaPeDiJeNeBu:2022}, for budgets $b=240.8$ and $b=960$. The iterative integer-valued scheme achieves better cost utilization than direct flooring while preserving the structure of the continuous optimizer.}
\label{tab:MFMC_integer_comparison_Eg3}
\end{table}



\subsection{Fourth example}

% %
% \begin{table}[ht]
% \centering
% \scalebox{1}{
% \begin{tabular}{|c|c|c|c|c|c|c|}
% \hline
% Model index &1 &2 &3\\
% \hline
% Correlation coeff $\rho_{1,k}$ &1     &0.9997 &0.9465\\
% % \hline
% % Standard deviation $\sigma_k$ &0.03\\
% \hline
% Cost &1 &0.05  &0.001\\
% \hline
% \end{tabular}
% }
% \caption{Parameters of Ishigami function problem in \cite{QiPeOMVe:2018}. $b=2\times 10^2,2\times 10^3,2\times 10^4$.}
% \label{Tab:Eg4_Parameters}
% \end{table}
% %


% \begin{table}[ht]
% \centering
% \scalebox{0.73}{
% \begin{tabular}{|c|p{4.8cm}|c|c|p{4.8cm}|c|c|}
% \hline
% \multirow{2}{*}{Method} 
% & \multicolumn{3}{c|}{$b = 1.1$} 
% & \multicolumn{3}{c|}{$b = 2000$} \\
% \cline{2-7}
% & Sample size & Actual cost & Actual $f$ 
% & Sample size & Actual cost & Actual $f$ \\
% \hline
% Real-valued 
% & [2.1319e-01,   1.2526e+01,   2.6053e+02] 
% &1.1 &1.4519e-02
% & [3.8763e+02,   2.2774e+04,   4.7369e+05] 
% & 2000&7.9853e-06\\
% \hline
% Direct floor 
% & [0, 12, 260] 
% & 8.6000e-01&$\infty$
% & [387, 22773, 473686] 
% & 1.9993e+03&7.9879e-06\\
% \hline
% Modified 
% & [1, 1, 29] 
% &1.0790e+00 &1.3503e-01
% & \multicolumn{3}{c|}{---} \\
% \hline
% Iterative 
% & [1, 1, 50] 
% & 1.1000e+00&1.2205e-01
% & [387, 22782, 473899]
% & 2.0000e+03&7.9853e-06\\
% \hline
% Iterative (delete equal)
% & [1, -, 100] 
% & 1.1000e+00&1.1310e-01
% & \multicolumn{3}{c|}{---} \\
% \hline
% Iterative (adaptive)
% & [1, -, 100] 
% & 1.1000e+00&1.1310e-01
% & [388, 22768, 473600] 
% & 2000&7.9853e-06\\
% \hline
% Integer program
% & [1, -, 100] 
% & 1.1000e+00&1.1310e-01
% & [423,  22665, 443711] 
% & 2.0000e+03&8.0054e-06\\
% \hline
% \end{tabular}
% }
% \caption{Comparison of real-valued and integer-valued MFMC sample allocations for small and large budgets ($b=46$ and $b=248$). The iterative integer-valued scheme achieves better cost utilization than the direct flooring approach while preserving the structure of the continuous optimizer.}
% \label{tab:MFMC_integer_comparison_Eg4}
% \end{table}

% ===========================================
% Parameters + Results in Two-Block Layout
% ===========================================
\begin{table}[ht]
\centering
\scalebox{0.92}{
\begin{tabular}{cc} % no outer border

% ---------- LEFT: PARAMETERS ----------
\begin{minipage}{0.25\linewidth}
\centering
\small
\begin{tabular}{|c|c|}
\hline
\textbf{Model} & \textbf{$\rho_{1,k}$} \\
\hline
1 & 1 \\
2 & 0.9997 \\
3 & 0.9465 \\
\hline
&\textbf{Cost}\\
\hline
1 & 1 \\
2 & 0.05 \\
3 & 0.001 \\
\hline
\end{tabular}
\end{minipage}
&
% ---------- RIGHT: RESULTS ----------
\begin{minipage}{0.73\linewidth}
\centering
\small
\begin{tabular}{|c|p{4.9cm}|c|c|}
\hline
\textbf{Method} & \textbf{Sample size} & \textbf{Cost} & \textbf{$f$} \\ \hline

% ======= Budget block 1 =======
\multicolumn{4}{|c|}{\textbf{Budget: $b = 1.1$}} \\ \hline

Real-valued 
& [2.1319e-01, 1.2526e+01, 2.6053e+02]
& 1.10 & 1.4519e-02 \\ \hline

Direct floor 
& [0, 12, 260]
& 8.6000e-01 & $\infty$ \\ \hline

Modified 
& [1, 1, 29]
& 1.0790e+00 & 1.3503e-01 \\ \hline

Iterative 
& [1, 1, 50]
& 1.10 & 1.2205e-01 \\ \hline

Iterative (delete equal)
& [1, –, 100]
& 1.10 & 1.1310e-01 \\ \hline

Iterative (adaptive)
& [1, –, 100]
& 1.10 & 1.1310e-01 \\ \hline

Integer program
& [1, –, 100]
& 1.10 & 1.1310e-01 \\ \hline


% ======= Budget block 2 =======
\multicolumn{4}{|c|}{\textbf{Budget: $b = 2000$}} \\ \hline

Real-valued 
& [3.8763e+02, 2.2774e+04, 4.7369e+05]
& 2.0000e+03 & 7.9853e-06 \\ \hline

Direct floor 
& [387, 22773, 473686]
& 1.9993e+03 & 7.9879e-06 \\ \hline

Iterative 
& [387, 22782, 473899]
& 2.0000e+03 & 7.9853e-06 \\ \hline

Iterative (adaptive)
& [388, 22768, 473600]
& 2.0000e+03 & 7.9853e-06 \\ \hline

Integer program
& [388, 22768, 473600]
& 2.0000e+03 & 7.9853e-06 \\ \hline

\end{tabular}
\end{minipage}

\end{tabular}
}
\caption{Model parameters and MFMC sample allocations for the Ishigami example in \cite{QiPeOMVe:2018}, for budgets $b=1.1$ and $b=2000$. The iterative integer-valued schemes utilize the budget more effectively while preserving the structure of the continuous optimizer.}
\label{tab:MFMC_integer_comparison_Eg4}
\end{table}


\subsection{Fifth example}

% %
% \begin{table}[ht]
% \centering
% \scalebox{1}{
% \begin{tabular}{|c|c|c|c|c|c|c|c|c|c|c|c|c|c|}
% \hline
% Model index &1 &2 &3&4&5\\
% \hline
% Correlation coeff $\rho_{1,k}$ &1     &0.99838 &0.99245&0.96560&0.70267\\
% % \hline
% % Standard deviation $\sigma_k$ &0.03\\
% \hline
% Cost &1.000 &0.147 &0.026 &0.009 &0.002\\
% \hline
% \end{tabular}
% }
% \caption{ Two dimensional elasticity in heterogeneous media in \cite{GoGeElJa:2020}. $b=10\sim10^3$.}
% \label{Tab:Eg4_Parameters}
% \end{table}
% %


% \begin{table}[ht]
% \centering
% \scalebox{0.73}{
% \begin{tabular}{|c|p{4.8cm}|c|c|p{4.8cm}|c|c|}
% \hline
% \multirow{2}{*}{Method} 
% & \multicolumn{3}{c|}{$b = 14.05$} 
% & \multicolumn{3}{c|}{$b = 955.1$} \\
% \cline{2-7}
% & Sample size & Actual cost & Actual $f$ 
% & Sample size & Actual cost & Actual $f$ \\
% \hline
% Real-valued 
% & [3.4790e+00, 1.7328e+01, 8.6947e+01, 4.2686e+02, 9.6071e+02] 
% & 14.05 &3.7580e-03
% & [2.3650e+02, 1.1779e+03, 5.9105e+03, 2.9018e+04, 6.5308e+04] 
% & 9.5510e+02&5.5283e-05\\
% \hline
% Direct floor 
% & [3    17    86   426   960] 
% & 1.3489e+01&3.9289e-03
% & [236, 1177, 5910, 29017, 65307] 
% & 9.5445e+02 &5.5321e-05\\
% \hline
% Modified 
% & [] 
% & &
% & [] 
% & &\\
% \hline
% Iterative 
% & [3, 18, 91, 447, 1007] 
% & 1.4049e+01&3.7843e-03
% & [236, 1178, 5915, 29044, 65374] 
% &9.5510e+02 &5.5283e-05\\
% \hline
% Iterative (delete equal)
% & [] 
% & &
% & [] 
% & &\\
% \hline
% % & \multicolumn{3}{c|}{---} \\
% Iterative (adaptive)
% & [4,    16,    83,   410,   925] 
% & 1.4050e+01&3.7842e-03
% & [236, 1179, 5914, 29036, 65349] 
% &9.5510e+02 &5.5283e-05\\
% \hline
% Integer program
% & [3,   18,   91,  448, 1003] 
% &1.4050e+01 &3.7841e-03
% & [235,  1180,  5937, 29136, 65027] 
% & 9.5510e+02&5.5284e-05\\
% \hline
% \end{tabular}
% }
% \caption{Comparison of real-valued and integer-valued MFMC sample allocations for small and large budgets ($b=46$ and $b=248$). The iterative integer-valued scheme achieves better cost utilization than the direct flooring approach while preserving the structure of the continuous optimizer.}
% \label{tab:MFMC_integer_comparison_Eg5}
% \end{table}


% ===========================================
% Parameters + Results in Two-Block Layout
% ===========================================
\begin{table}[ht]
\centering
\scalebox{0.90}{
\begin{tabular}{cc} % no outer border

% ---------- LEFT: PARAMETERS ----------
\begin{minipage}{0.27\linewidth}
\centering
\small
\begin{tabular}{|c|c|}
\hline
\textbf{Model} & \textbf{$\rho_{1,k}$} \\
\hline
1 & 1      \\
2 & 0.99838 \\
3 & 0.99245 \\
4 & 0.96560 \\
5 & 0.70267 \\
\hline
& \textbf{Cost} \\
\hline
1 & 1.000 \\
2 & 0.147 \\
3 & 0.026 \\
4 & 0.009 \\
5 & 0.002 \\
\hline
\end{tabular}
\end{minipage}
&
% ---------- RIGHT: RESULTS ----------
\begin{minipage}{0.73\linewidth}
\centering
\small
\begin{tabular}{|c|p{5.4cm}|c|c|}
\hline
\textbf{Method} & \textbf{Sample size} & \textbf{Cost} & \textbf{$f$} \\ \hline

% ===== Budget 1 =====
\multicolumn{4}{|c|}{\textbf{Budget: $b = 14.05$}} \\ \hline

Real-valued 
& [3.5196e+00   1.7530e+01   8.7962e+01   6.2961e+02]
& 1.4050e+01 & 3.6718e-03
 \\ \hline

Direct floor 
& [3,    17,    87,   629]
& 1.3422e+01 & 3.8602e-03 \\ \hline

% Modified 
% & [\,]
% & --- & --- \\ \hline

Iterative 
& [3,    18,    92,   668]
& 1.4050e+01 & 3.7022e-03 \\ \hline

% Iterative (delete equal)
% & [\,]
% & --- & --- \\ \hline

Iterative (adaptive)
& [4,    17,    84,   596]
&1.4047e+01 &3.6941e-03 \\ \hline

Integer program
& [4, 17, 82, 602]
& 1.4049e+01 & 3.6937e-03 \\ \hline

% ===== Budget 2 =====
\multicolumn{4}{|c|}{\textbf{Budget: $b = 955.1$}} \\ \hline

Real-valued 
& [2.3926e+02,   1.1917e+03,   5.9795e+03,   4.2800e+04]
& 9.5510e+02 & 5.4015e-05 \\ \hline

Direct floor 
& [239, 1191, 5979, 42800]
& 9.5473e+02 & 5.4036e-05\\ \hline

% Modified 
% & [\,]
% & --- & --- \\ \hline

Iterative 
& [239,        1192,        5981,       42818]
& 9.5509e+02& 5.4015e-05\\ \hline

Iterative (adaptive)
& [239,        1192,        5982,       42816]
& 9.5510e+02 & 5.4015e-05\\ \hline

Integer program
& [239, 1192, 5982, 42816]
& 9.5510e+02 & 5.4015e-05 \\ \hline

\end{tabular}
\end{minipage}

\end{tabular}
}
\caption{Model parameters and MFMC sample allocations for the heterogeneous elasticity example in \cite{GoGeElJa:2020}, for budgets $b=14.05$ and $b=955.1$. The iterative integer schemes improve cost utilization while preserving the structure of the continuous optimizer.}
\label{tab:MFMC_integer_comparison_Eg5}
\end{table}



% %
% \begin{table}[ht]
% \centering
% \scalebox{0.6}{
% \begin{tabular}{|c|c|c|c|c|c|c|c|c|c|}
% \hline
% Total cost $P$ &73.05 &73.051 &73.052 &73.053 &73.054 &73.055 &73.056\\
% \hline
% Sample size (real valued) &[1,   134,   588   2540,  21100] &[1,   135,   588,   2541,  21101]&same &same &[1,   135,   588,   2541,  21102] &same &same\\
% \hline
% Sample size (integer program) &[1, 2, 3, 11, 97]&[1, 2, 3, 12, 99]&-&-&-&-&-\\
% \hline
% CPU time for integer program [s] & 0.27 &0.32 &$>$ 1000 &$>$ 1000 &$>$ 1000 &$>$ 1000 &$>$ 1000\\
% \hline
% \end{tabular}
% }
% \caption{Sample size for real-valued optimization and integer optimization.}
% \label{Tab:Sample_Size}
% \end{table}
% %








% %
% \begin{table}[ht]
% \centering
% \scalebox{1}{
% \begin{tabular}{|c|c|c|c|c|c|c|c|c|c|}
% \hline
% &Sample size &Total cost $p$ &$f$\\
% \hline
% Real valued &[2.4129e+00 3.6959e+02 1.6102e+03 6.9567e+03 5.7770e+04]&200&2.1645e-04\\
% \hline
% Integer, floor &[2, 369, 1610, 6956, 57769]&1.698561e+02&2.5580e-04\\
% \hline
% Integer, iterative&[2, 836, 3644, 15744, 130749]&1.999999e+02&2.4138e-04\\
% % \hline
% % CPU time for integer program [s] & 0.27\\
% \hline
% \end{tabular}
% }
% \caption{Sample size for real-valued optimization and integer optimization for $p=200$.}
% \label{Tab:Eg1_p_large}
% \end{table}
% %

% %
% \begin{table}[ht]
% \centering
% \scalebox{1}{
% \begin{tabular}{|c|c|c|c|c|c|c|c|c|c|}
% \hline
% &Sample size &Total cost $p$ &$f$\\
% \hline
% Real valued &[8.8106e-01,   1.3495e+02,   5.8795e+02,   2.5402e+03,  2.1095e+04]&73.03&5.9275e-04\\
% \hline
% Integer, floor &[0,         134,         587,        2540,  21094]&8.7045&$\infty$\\
% \hline
% Modified &[1,     1,     1,     7,    62]&7.302859e+01&2.4834e-02\\
% % \hline
% \hline
% Integer, iterative &[1,     1,     1,     7,    67]&7.302993e+01&2.3668e-02\\
% % \hline
% % CPU time for integer program [s] & 0.27\\
% \hline
% \end{tabular}
% }
% \caption{Sample size for real-valued optimization and integer optimization for $p=73.03$.}
% \label{Tab:Eg1_p_small}
% \end{table}
% %



% %
% \begin{table}[ht]
% \centering
% \scalebox{1}{
% \begin{tabular}{|c|c|c|c|c|c|c|c|c|c|}
% \hline
% &Sample size &Total cost $p$ &$f$\\
% \hline
% Real valued &[1.449950e+00 1.267731e+01 3.307436e+02 1.403572e+05]&200&5.0571e-05\\
% \hline
% Integer, floor &[1, 12, 330, 140357]&1.793385e+02&5.8074e-05\\
% \hline
% Integer, iterative&[1, 14, 380, 162081]&1.999999e+02&5.3495e-05\\
% % \hline
% % CPU time for integer program [s] & 0.27\\
% \hline
% \end{tabular}
% }
% \caption{Sample size for real-valued optimization and integer optimization for $p=200$.}
% \label{Tab:Eg2_p_large}
% \end{table}
% %



% %
% \begin{table}[ht]
% \centering
% \scalebox{1}{
% \begin{tabular}{|c|c|c|c|c|c|c|c|c|c|}
% \hline
% &Sample size &Total cost $p$ &$f$\\
% \hline
% Real valued &[3.334886e-01 2.915781e+00 7.607103e+01 3.228216e+04]&46&2.1987267e-04\\
% \hline
% Integer, floor &[0, 2, 76, 32282]&3.054700e+01&$\infty$\\
% \hline
% Modified &[1, 1, 2, 1018]&4.588049e+01&5.1658e-03\\
% % \hline
% \hline
% Integer, iterative &[1, 1, 2, 1618]&4.599994e+01&4.8046e-03\\
% % \hline
% % CPU time for integer program [s] & 0.27\\
% \hline
% \end{tabular}
% }
% \caption{Sample size for real-valued optimization and integer optimization for $p=46$.}
% \label{Tab:Eg2_p_small}
% \end{table}
% %