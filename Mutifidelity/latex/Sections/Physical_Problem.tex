% ========================================
\section{The Grad-Shafranov free boundary problem with uncertainty}\label{sec:Grad-Shafranov}
% ========================================
In magnetic confinement fusion reactors, atoms with light nuclei such as deuterium and tritium are injected into a chamber and heated to high temperature, ionizing to form a hot plasma. To maintain the conditions required for nuclear fusion, magnetic fields generated by external coils are used to confine the plasma and isolate it from the reactor wall. The confinement is governed by a balance between hydrostatic pressure and magnetic pressure generated from the external coils and internal plasma current. The equilibrium state, coupled with Maxwell’s equations,  is mathematically described by the Grad–Shafranov equation \cite{GrRu:1958, LuSc:1957, Shafranov:1958}. In axially symmetric tokamaks configurations, the problem simplifies to a two-dimensional formulation in the meridional $r$-$z$ plane using cylindrical coordinates $(r, z, \varphi)$. The equation determines the poloidal flux function $u(r,z)$ from 
%
\begin{subequations}\label{eq:FreeBoundary}
\begin{equation}
 -\nabla\,\cdot\,\left(\frac{1}{\mu r}\nabla u\right) = \left\{ \begin{array}{ll}
r\frac{d}{d u} p(u) + \frac{1}{2\,\mu r} \frac{d}{d u} g^2(u) & \text{ in } \Omega_p(u) \\
I_k/S_k & \text{ in } \Omega_{C_k} \\
0 & \text{ elsewhere, } 
\end{array}\right.
\end{equation}
%
where $\nabla$ and $\nabla\cdot$ denote the Cartesian gradient and divergence operators in two dimensions; the magnetic permeability $\mu$ is a constant $\mu_0$ in vacuum but varies as  $\mu = \mu(|\nabla u|^2/r^2)$ within ferromagnetic materials; the regions $\Omega_p$ and $\Omega_{C_k}$ correspond to the plasma confinement zone and the meridian cross-sections of external coils, respectively, with the latter carrying currents $I_k$ over areas $S_k$; the source term in $\Omega_p$ represents the toroidal component of the plasma current density, which depends non-linearly on the poloidal flux through the hydrostatic pressure $p(u)$ and toroidal magnetic field $g(u)$. We adopt experimentally motivated formulations for  $p(u)$ and $g(u)$ proposed in \cite{LuBr:1982} as
%
\begin{equation}\label{eq:source}
\frac{d}{d u}p( u) = j_0\frac{\beta}{r_0}\left(1-u_N^{\alpha_1}\right)^{\alpha_2},  \qquad \qquad
\frac{1}{2}\frac{d}{d u}g^2(u) = j_0\mu_0r_0(1-\beta)\left(1-u_N^{\alpha_1}\right)^{\alpha_2},
\end{equation}
\end{subequations}
%
where $u_N \in [0,1]$ is the normalized flux, scaled by the difference between its values at the \textit{magnetic axis} and the plasma boundary; the parameter $r_0$ denotes the outer radius of the vacuum chamber, $\alpha_1$ and $\alpha_2$ dictate the sharpness of the current peaks near the magnetic axis, and $\beta$, the \textit{poloidal beta}, measures the ratio of \textit{plasma pressure} to \textit{magnetic pressure}. The plasma boundary $\Omega_p$, delineated by the last closed streamline,  is dependent on $u$ and unknown a priori, introducing a \textit{free boundary problem}. The nonlinear dependence of the poloidal flux, combined with the magnetic permeability and the nonlinearity of $p(u)$ and $g(u)$, significantly contributes to the mathematical complexity of the Grad-Shafranov equation.

Let $\Omega$ be a bounded, Lipschitz domain enclosing the confinement region $\Omega_p$, the external coils $\Omega_{c_i}$, and all other structural components of the reactor.
The solution space $Z$ for \eqref{eq:FreeBoundary}, as defined in \cite{Gr:1999}, is
%
\begin{equation}\label{eq:Soln_space}
    Z:=\left\{u:\Omega\rightarrow \mathbb{R} \,\Bigg| \,\int_\Omega u^2rdrdz<\infty; \,  \int_\Omega\frac{|\nabla u|^2}{r}drdz<\infty; \, u(0,z)=0 \right\}\cap C^0(\overline{\Omega}),
\end{equation}
%
ensuring finite energy and continuity over $\overline\Omega$. The corresponding inner product and energy norm are
%
\[
    \langle u,v\rangle_Z := \int_{\Omega} \frac{1}{r} \nabla u\cdot\nabla v \;\;drdz,\qquad \| u \|_{Z} :=\left(\int_\Omega\frac{|\nabla u|^2}{r} drdz\right)^{1/2}.
\]
%
In practice, the equilibrium state of the plasma is vulnerable to uncertainties arising from sources such as measurement inaccuracies and operational fluctuations. These uncertainties manifest themselves as stochastic variations in the solution and its derived quantities, influencing the stability and performance of plasma confinement. This paper investigates the impact of parametric uncertainties on two key factors: the current intensities $I_k$ of the external coils and the parameters governing the source term \eqref{eq:source}. To model these uncertainties, we define a $d$-dimensional random variable $\boldsymbol \omega :=(\omega_1,\ldots,\omega_d)$,  where each component $\omega_i$ is treated as an independent random variable characterized by a probability density function $\pi_k$. The baseline values for these parameters are denoted by the vector $\boldsymbol{\widetilde{\omega}} = (\widetilde{\omega}_1, \ldots, \widetilde{\omega}_d)$. Assuming a uniform distribution for each parameter, centered around its corresponding baseline value $\widetilde{\omega}_i$ and perturbed by a relative magnitude $\tau$, the joint probability density function $\pi(\boldsymbol{\widetilde{\omega}})$ and the associated $d$-dimensional parameter space $W$ are
%
\begin{equation}
\label{eq:ParameterSpace}
 \pi \left(\boldsymbol{\omega}\right)=\prod_{k=1}^{d} \pi_k\left(\omega_{k}\right)=\prod_{k=1}^{d} \frac{1}{2\tau |\widetilde{\omega}_k|}, \qquad  
    W := \prod_{k=1}^{d}\left[\widetilde{\omega}_k-\tau \left\vert \widetilde{\omega}_k\right\vert,\widetilde{\omega}_k+\tau \left\vert \widetilde{\omega}_k \right\vert\right].
\end{equation}
%
Incorporating stochasticity into the current intensities and the source function requires solving for a solution operator $u(\cdot, \boldsymbol{\omega}): W \to Z$, which maps the realizations of the random variable $\boldsymbol \omega$ to the corresponding solutions of the free-boundary problem \eqref{eq:FreeBoundary}. To address the variability introduced by stochastic parameters, we adopt the {\it weighted Bochner space} framework, which provides a rigorous way to quantify combined spatial and parametric variability. For a stochastic function $u: W\to Z$, we consider function space $L^2(W,Z)$, consisting of functions with finite second moments, defined as
%
\[
L^2(W,Z) = \{u:W\rightarrow Z\big\vert u \text{ is strongly mearurable and }\int_{W}\left\|u(\cdot,\boldsymbol{\omega})\right\|_{Z}^2\pi(\boldsymbol{\omega})d\boldsymbol{\omega}<\infty\},
\]
%
and the associated norm is defined as
\[
\left\Vert u \right\Vert_{L^2(\boldsymbol W,Z)} =
    \left(\int_{\boldsymbol W} \left\Vert u(\cdot,\boldsymbol{\omega})  \right\Vert_{Z}^2 \pi(\boldsymbol{\omega})d\boldsymbol{\omega} \right)^{1/2} = \left(\mathbb{E}\left[\left\Vert u(\cdot,\boldsymbol{\omega})  \right\Vert_{Z}^2\right]\right)^{1/2}\,. 
\]

The goal of this paper is to explore the propagation of uncertainty and efficiently approximate the parametric expectation of $u(\cdot,\boldsymbol \omega)$
%
 \begin{equation}
 \label{eq:QoI}
      \mathbb{E}\left(u(\cdot,\boldsymbol \omega)\right)=\int_W u(\cdot,\boldsymbol{\omega})\pi(\boldsymbol\omega)d\boldsymbol{\omega},
 \end{equation}
%
and to compute some derived quantities from \eqref{eq:QoI}, such as the plasma boundary and features of solutions such as the locations of x-points. 


To achieve computational efficiency, we use sampling techniques including Monte Carlo and multi-fidelity Monte Carlo methods. The high-fidelity model in the multi-fidelity Monte Carlo framework is implemented using the finite element-based solver {\tt FEEQS.m} \cite{Heumann:feeqsm} -- a lightweight Matlab implementation of the {\tt CEDRES++} code \cite{FaHe:2017,CEDRES}, developed by Holger Heumann and collaborators; it implements a piecewise linear Finite Element discretization of a weak formulation of \eqref{eq:FreeBoundary} and incorporates a globalized variant of Newton's method to resolve its inherent nonlinearity. Hereafter, we refer to this solver as the  {\it direct solver}. Moreover, the multi-fidelity framework relies on a sequence of low-fidelity models to mitigate the computational cost associated with the high-fidelity model. To construct these low-fidelity models for $u(\cdot, \boldsymbol{\omega})$, we use the sparse grid stochastic collocation method \cite{BaNoRi:2000, KlBa:2005, MaNi:2009, Sm:1963}.






% Incorporating the uncertainty and 
% %
% \begin{equation}\label{eq:FreeBoundarya}
%  -\nabla\,\cdot\,\left(\frac{1}{\mu(u(\cdot, \boldsymbol{\omega})) r}\nabla u(\cdot, \boldsymbol{\omega})\right) = \left\{ \begin{array}{ll}
% \frac{d}{du} p(u(\cdot, \boldsymbol{\omega})) + \frac{1}{2\,\mu r} \frac{d}{du} g^2(u(\cdot, \boldsymbol{\omega})) & \text{ in } \Omega_p(u(\cdot, \boldsymbol{\omega})) \\
% I_k(\boldsymbol\omega)/S_k & \text{ in } \Omega_{C_k} \\
% 0 & \text{ elsewhere, } 
% \end{array}\right.
% \end{equation}
